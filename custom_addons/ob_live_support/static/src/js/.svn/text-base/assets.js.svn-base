
/* /web/static/lib/moment/moment.js defined in bundle 'odoo_support_livechat.odoo_livechat_external_assets' */
(function(undefined){var moment,VERSION='2.8.1',globalScope=typeof global!=='undefined'?global:this,oldGlobalMoment,round=Math.round,i,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule=(typeof module!=='undefined'&&module.exports),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat='YYYY-MM-DDTHH:mm:ssZ',isoDates=[['YYYYYY-MM-DD',/[+-]\d{6}-\d{2}-\d{2}/],['YYYY-MM-DD',/\d{4}-\d{2}-\d{2}/],['GGGG-[W]WW-E',/\d{4}-W\d{2}-\d/],['GGGG-[W]WW',/\d{4}-W\d{2}/],['YYYY-DDD',/\d{4}-\d{3}/]],isoTimes=[['HH:mm:ss.SSSS',/(T| )\d\d:\d\d:\d\d\.\d+/],['HH:mm:ss',/(T| )\d\d:\d\d:\d\d/],['HH:mm',/(T| )\d\d:\d\d/],['HH',/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters='Date|Hours|Minutes|Seconds|Milliseconds'.split('|'),unitMillisecondFactors={'Milliseconds':1,'Seconds':1e3,'Minutes':6e4,'Hours':36e5,'Days':864e5,'Months':2592e6,'Years':31536e6},unitAliases={ms:'millisecond',s:'second',m:'minute',h:'hour',d:'day',D:'date',w:'week',W:'isoWeek',M:'month',Q:'quarter',y:'year',DDD:'dayOfYear',e:'weekday',E:'isoWeekday',gg:'weekYear',GG:'isoWeekYear'},camelFunctions={dayofyear:'dayOfYear',isoweekday:'isoWeekday',isoweek:'isoWeek',weekyear:'weekYear',isoweekyear:'isoWeekYear'},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens='DDD w W M D d'.split(' '),paddedTokens='M D H h m s w W'.split(' '),formatTokenFunctions={M:function(){return this.month()+1;},MMM:function(format){return this.localeData().monthsShort(this,format);},MMMM:function(format){return this.localeData().months(this,format);},D:function(){return this.date();},DDD:function(){return this.dayOfYear();},d:function(){return this.day();},dd:function(format){return this.localeData().weekdaysMin(this,format);},ddd:function(format){return this.localeData().weekdaysShort(this,format);},dddd:function(format){return this.localeData().weekdays(this,format);},w:function(){return this.week();},W:function(){return this.isoWeek();},YY:function(){return leftZeroFill(this.year()%100,2);},YYYY:function(){return leftZeroFill(this.year(),4);},YYYYY:function(){return leftZeroFill(this.year(),5);},YYYYYY:function(){var y=this.year(),sign=y>=0?'+':'-';return sign+leftZeroFill(Math.abs(y),6);},gg:function(){return leftZeroFill(this.weekYear()%100,2);},gggg:function(){return leftZeroFill(this.weekYear(),4);},ggggg:function(){return leftZeroFill(this.weekYear(),5);},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2);},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4);},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5);},e:function(){return this.weekday();},E:function(){return this.isoWeekday();},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),true);},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),false);},H:function(){return this.hours();},h:function(){return this.hours()%12||12;},m:function(){return this.minutes();},s:function(){return this.seconds();},S:function(){return toInt(this.milliseconds()/100);},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2);},SSS:function(){return leftZeroFill(this.milliseconds(),3);},SSSS:function(){return leftZeroFill(this.milliseconds(),3);},Z:function(){var a=-this.zone(),b='+';if(a<0){a=-a;b='-';}
return b+leftZeroFill(toInt(a/60),2)+':'+leftZeroFill(toInt(a)%60,2);},ZZ:function(){var a=-this.zone(),b='+';if(a<0){a=-a;b='-';}
return b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2);},z:function(){return this.zoneAbbr();},zz:function(){return this.zoneName();},X:function(){return this.unix();},Q:function(){return this.quarter();}},deprecations={},lists=['months','monthsShort','weekdays','weekdaysShort','weekdaysMin'];function dfl(a,b,c){switch(arguments.length){case 2:return a!=null?a:b;case 3:return a!=null?a:b!=null?b:c;default:throw new Error('Implement me');}}
function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false};}
function printMsg(msg){if(moment.suppressDeprecationWarnings===false&&typeof console!=='undefined'&&console.warn){console.warn("Deprecation warning: "+msg);}}
function deprecate(msg,fn){var firstTime=true;return extend(function(){if(firstTime){printMsg(msg);firstTime=false;}
return fn.apply(this,arguments);},fn);}
function deprecateSimple(name,msg){if(!deprecations[name]){printMsg(msg);deprecations[name]=true;}}
function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count);};}
function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period);};}
while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+'o']=ordinalizeToken(formatTokenFunctions[i],i);}
while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);}
formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function Locale(){}
function Moment(config,skipOverflow){if(skipOverflow!==false){checkOverflow(config);}
copyConfig(this,config);this._d=new Date(+config._d);}
function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+
seconds*1e3+
minutes*6e4+
hours*36e5;this._days=+days+
weeks*7;this._months=+months+
quarters*3+
years*12;this._data={};this._locale=moment.localeData();this._bubble();}
function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i];}}
if(b.hasOwnProperty('toString')){a.toString=b.toString;}
if(b.hasOwnProperty('valueOf')){a.valueOf=b.valueOf;}
return a;}
function copyConfig(to,from){var i,prop,val;if(typeof from._isAMomentObject!=='undefined'){to._isAMomentObject=from._isAMomentObject;}
if(typeof from._i!=='undefined'){to._i=from._i;}
if(typeof from._f!=='undefined'){to._f=from._f;}
if(typeof from._l!=='undefined'){to._l=from._l;}
if(typeof from._strict!=='undefined'){to._strict=from._strict;}
if(typeof from._tzm!=='undefined'){to._tzm=from._tzm;}
if(typeof from._isUTC!=='undefined'){to._isUTC=from._isUTC;}
if(typeof from._offset!=='undefined'){to._offset=from._offset;}
if(typeof from._pf!=='undefined'){to._pf=from._pf;}
if(typeof from._locale!=='undefined'){to._locale=from._locale;}
if(momentProperties.length>0){for(i in momentProperties){prop=momentProperties[i];val=from[prop];if(typeof val!=='undefined'){to[prop]=val;}}}
return to;}
function absRound(number){if(number<0){return Math.ceil(number);}else{return Math.floor(number);}}
function leftZeroFill(number,targetLength,forceSign){var output=''+Math.abs(number),sign=number>=0;while(output.length<targetLength){output='0'+output;}
return(sign?(forceSign?'+':''):'-')+output;}
function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+
(other.year()-base.year())*12;if(base.clone().add(res.months,'M').isAfter(other)){--res.months;}
res.milliseconds=+other-+(base.clone().add(res.months,'M'));return res;}
function momentsDifference(base,other){var res;other=makeAs(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other);}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months;}
return res;}
function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period).");tmp=val;val=period;period=tmp;}
val=typeof val==='string'?+val:val;dur=moment.duration(val,period);addOrSubtractDurationFromMoment(this,dur,direction);return this;};}
function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding);}
if(days){rawSetter(mom,'Date',rawGetter(mom,'Date')+days*isAdding);}
if(months){rawMonthSetter(mom,rawGetter(mom,'Month')+months*isAdding);}
if(updateOffset){moment.updateOffset(mom,days||months);}}
function isArray(input){return Object.prototype.toString.call(input)==='[object Array]';}
function isDate(input){return Object.prototype.toString.call(input)==='[object Date]'||input instanceof Date;}
function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++;}}
return diffs+lengthDiff;}
function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,'$1');units=unitAliases[units]||camelFunctions[lowered]||lowered;}
return units;}
function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(inputObject.hasOwnProperty(prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop];}}}
return normalizedInput;}
function makeList(field){var count,setter;if(field.indexOf('week')===0){count=7;setter='day';}
else if(field.indexOf('month')===0){count=12;setter='month';}
else{return;}
moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if(typeof format==='number'){index=format;format=undefined;}
getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||'');};if(index!=null){return getter(index);}
else{for(i=0;i<count;i++){results.push(getter(i));}
return results;}};}
function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){if(coercedNumber>=0){value=Math.floor(coercedNumber);}else{value=Math.ceil(coercedNumber);}}
return value;}
function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate();}
function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week;}
function daysInYear(year){return isLeapYear(year)?366:365;}
function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0;}
function checkOverflow(m){var overflow;if(m._a&&m._pf.overflow===-2){overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1;if(m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE;}
m._pf.overflow=overflow;}}
function isValid(m){if(m._isValid==null){m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated;if(m._strict){m._isValid=m._isValid&&m._pf.charsLeftOver===0&&m._pf.unusedTokens.length===0;}}
return m._isValid;}
function normalizeLocale(key){return key?key.toLowerCase().replace('_','-'):key;}
function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split('-');j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split('-'):null;while(j>0){locale=loadLocale(split.slice(0,j).join('-'));if(locale){return locale;}
if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break;}
j--;}
i++;}
return null;}
function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule){try{oldLocale=moment.locale();require('./locale/'+name);moment.locale(oldLocale);}catch(e){}}
return locales[name];}
function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local();}
extend(Locale.prototype,{set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==='function'){this[i]=prop;}else{this['_'+i]=prop;}}},_months:'January_February_March_April_May_June_July_August_September_October_November_December'.split('_'),months:function(m){return this._months[m.month()];},_monthsShort:'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_'),monthsShort:function(m){return this._monthsShort[m.month()];},monthsParse:function(monthName){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[];}
for(i=0;i<12;i++){if(!this._monthsParse[i]){mom=moment.utc([2000,i]);regex='^'+this.months(mom,'')+'|^'+this.monthsShort(mom,'');this._monthsParse[i]=new RegExp(regex.replace('.',''),'i');}
if(this._monthsParse[i].test(monthName)){return i;}}},_weekdays:'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_'),weekdays:function(m){return this._weekdays[m.day()];},_weekdaysShort:'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_'),weekdaysShort:function(m){return this._weekdaysShort[m.day()];},_weekdaysMin:'Su_Mo_Tu_We_Th_Fr_Sa'.split('_'),weekdaysMin:function(m){return this._weekdaysMin[m.day()];},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[];}
for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2000,1]).day(i);regex='^'+this.weekdays(mom,'')+'|^'+this.weekdaysShort(mom,'')+'|^'+this.weekdaysMin(mom,'');this._weekdaysParse[i]=new RegExp(regex.replace('.',''),'i');}
if(this._weekdaysParse[i].test(weekdayName)){return i;}}},_longDateFormat:{LT:'h:mm A',L:'MM/DD/YYYY',LL:'MMMM D, YYYY',LLL:'MMMM D, YYYY LT',LLLL:'dddd, MMMM D, YYYY LT'},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1);});this._longDateFormat[key]=output;}
return output;},isPM:function(input){return((input+'').toLowerCase().charAt(0)==='p');},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?'pm':'PM';}else{return isLower?'am':'AM';}},_calendar:{sameDay:'[Today at] LT',nextDay:'[Tomorrow at] LT',nextWeek:'dddd [at] LT',lastDay:'[Yesterday at] LT',lastWeek:'[Last] dddd [at] LT',sameElse:'L'},calendar:function(key,mom){var output=this._calendar[key];return typeof output==='function'?output.apply(mom):output;},_relativeTime:{future:'in %s',past:'%s ago',s:'a few seconds',m:'a minute',mm:'%d minutes',h:'an hour',hh:'%d hours',d:'a day',dd:'%d days',M:'a month',MM:'%d months',y:'a year',yy:'%d years'},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(typeof output==='function')?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number);},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?'future':'past'];return typeof format==='function'?format(output):format.replace(/%s/i,output);},ordinal:function(number){return this._ordinal.replace('%d',number);},_ordinal:'%d',preparse:function(string){return string;},postformat:function(string){return string;},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week;},_week:{dow:0,doy:6},_invalidDate:'Invalid date',invalidDate:function(){return this._invalidDate;}});function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,'');}
return input.replace(/\\/g,'');}
function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]];}else{array[i]=removeFormattingTokens(array[i]);}}
return function(mom){var output='';for(i=0;i<length;i++){output+=array[i]instanceof Function?array[i].call(mom,format):array[i];}
return output;};}
function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate();}
format=expandFormat(format,m.localeData());if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format);}
return formatFunctions[format](m);}
function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input;}
localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1;}
return format;}
function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case'Q':return parseTokenOneDigit;case'DDDD':return parseTokenThreeDigits;case'YYYY':case'GGGG':case'gggg':return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case'Y':case'G':case'g':return parseTokenSignedNumber;case'YYYYYY':case'YYYYY':case'GGGGG':case'ggggg':return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case'S':if(strict){return parseTokenOneDigit;}
case'SS':if(strict){return parseTokenTwoDigits;}
case'SSS':if(strict){return parseTokenThreeDigits;}
case'DDD':return parseTokenOneToThreeDigits;case'MMM':case'MMMM':case'dd':case'ddd':case'dddd':return parseTokenWord;case'a':case'A':return config._locale._meridiemParse;case'X':return parseTokenTimestampMs;case'Z':case'ZZ':return parseTokenTimezone;case'T':return parseTokenT;case'SSSS':return parseTokenDigits;case'MM':case'DD':case'YY':case'GG':case'gg':case'HH':case'hh':case'mm':case'ss':case'ww':case'WW':return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case'M':case'D':case'd':case'H':case'h':case'm':case's':case'w':case'W':case'e':case'E':return parseTokenOneOrTwoDigits;case'Do':return parseTokenOrdinal;default:a=new RegExp(regexpEscape(unescapeFormat(token.replace('\\','')),'i'));return a;}}
function timezoneMinutesFromString(string){string=string||'';var possibleTzMatches=(string.match(parseTokenTimezone)||[]),tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+'').match(parseTimezoneChunker)||['-',0,0],minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==='+'?-minutes:minutes;}
function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case'Q':if(input!=null){datePartArray[MONTH]=(toInt(input)-1)*3;}
break;case'M':case'MM':if(input!=null){datePartArray[MONTH]=toInt(input)-1;}
break;case'MMM':case'MMMM':a=config._locale.monthsParse(input);if(a!=null){datePartArray[MONTH]=a;}else{config._pf.invalidMonth=input;}
break;case'D':case'DD':if(input!=null){datePartArray[DATE]=toInt(input);}
break;case'Do':if(input!=null){datePartArray[DATE]=toInt(parseInt(input,10));}
break;case'DDD':case'DDDD':if(input!=null){config._dayOfYear=toInt(input);}
break;case'YY':datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case'YYYY':case'YYYYY':case'YYYYYY':datePartArray[YEAR]=toInt(input);break;case'a':case'A':config._isPm=config._locale.isPM(input);break;case'H':case'HH':case'h':case'hh':datePartArray[HOUR]=toInt(input);break;case'm':case'mm':datePartArray[MINUTE]=toInt(input);break;case's':case'ss':datePartArray[SECOND]=toInt(input);break;case'S':case'SS':case'SSS':case'SSSS':datePartArray[MILLISECOND]=toInt(('0.'+input)*1000);break;case'X':config._d=new Date(parseFloat(input)*1000);break;case'Z':case'ZZ':config._useUTC=true;config._tzm=timezoneMinutesFromString(input);break;case'dd':case'ddd':case'dddd':a=config._locale.weekdaysParse(input);if(a!=null){config._w=config._w||{};config._w['d']=a;}else{config._pf.invalidWeekday=input;}
break;case'w':case'ww':case'W':case'WW':case'd':case'e':case'E':token=token.substr(0,1);case'gggg':case'GGGG':case'GGGGG':token=token.substr(0,2);if(input){config._w=config._w||{};config._w[token]=toInt(input);}
break;case'gg':case'GG':config._w=config._w||{};config._w[token]=moment.parseTwoDigitYear(input);}}
function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year);week=dfl(w.W,1);weekday=dfl(w.E,1);}else{dow=config._locale._week.dow;doy=config._locale._week.doy;weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year);week=dfl(w.w,1);if(w.d!=null){weekday=w.d;if(weekday<dow){++week;}}else if(w.e!=null){weekday=w.e+dow;}else{weekday=dow;}}
temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear;}
function dateFromConfig(config){var i,date,input=[],currentDate,yearToUse;if(config._d){return;}
currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config);}
if(config._dayOfYear){yearToUse=dfl(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)){config._pf._overflowDayOfYear=true;}
date=makeUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate();}
for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i];}
for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i];}
config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input);if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()+config._tzm);}}
function dateFromObject(config){var normalizedInput;if(config._d){return;}
normalizedInput=normalizeObjectUnits(config._i);config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond];dateFromConfig(config);}
function currentDateArray(config){var now=new Date();if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()];}else{return[now.getFullYear(),now.getMonth(),now.getDate()];}}
function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601){parseISO(config);return;}
config._a=[];config._pf.empty=true;var string=''+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){config._pf.unusedInput.push(skipped);}
string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length;}
if(formatTokenFunctions[token]){if(parsedInput){config._pf.empty=false;}
else{config._pf.unusedTokens.push(token);}
addTimeToArrayFromToken(token,parsedInput,config);}
else if(config._strict&&!parsedInput){config._pf.unusedTokens.push(token);}}
config._pf.charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){config._pf.unusedInput.push(string);}
if(config._isPm&&config._a[HOUR]<12){config._a[HOUR]+=12;}
if(config._isPm===false&&config._a[HOUR]===12){config._a[HOUR]=0;}
dateFromConfig(config);checkOverflow(config);}
function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4;});}
function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');}
function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){config._pf.invalidFormat=true;config._d=new Date(NaN);return;}
for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);tempConfig._pf=defaultParsingFlags();tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue;}
currentScore+=tempConfig._pf.charsLeftOver;currentScore+=tempConfig._pf.unusedTokens.length*10;tempConfig._pf.score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig;}}
extend(config,bestMoment||tempConfig);}
function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){config._pf.iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||' ');break;}}
for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break;}}
if(string.match(parseTokenTimezone)){config._f+='Z';}
makeDateFromStringAndFormat(config);}else{config._isValid=false;}}
function makeDateFromString(config){parseISO(config);if(config._isValid===false){delete config._isValid;moment.createFromInputFallback(config);}}
function makeDateFromInput(config){var input=config._i,matched;if(input===undefined){config._d=new Date();}else if(isDate(input)){config._d=new Date(+input);}else if((matched=aspNetJsonRegex.exec(input))!==null){config._d=new Date(+matched[1]);}else if(typeof input==='string'){makeDateFromString(config);}else if(isArray(input)){config._a=input.slice(0);dateFromConfig(config);}else if(typeof(input)==='object'){dateFromObject(config);}else if(typeof(input)==='number'){config._d=new Date(input);}else{moment.createFromInputFallback(config);}}
function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y);}
return date;}
function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y);}
return date;}
function parseWeekday(input,locale){if(typeof input==='string'){if(!isNaN(input)){input=parseInt(input,10);}
else{input=locale.weekdaysParse(input);if(typeof input!=='number'){return null;}}}
return input;}
function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture);}
function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as('s')),minutes=round(duration.as('m')),hours=round(duration.as('h')),days=round(duration.as('d')),months=round(duration.as('M')),years=round(duration.as('y')),args=seconds<relativeTimeThresholds.s&&['s',seconds]||minutes===1&&['m']||minutes<relativeTimeThresholds.m&&['mm',minutes]||hours===1&&['h']||hours<relativeTimeThresholds.h&&['hh',hours]||days===1&&['d']||days<relativeTimeThresholds.d&&['dd',days]||months===1&&['M']||months<relativeTimeThresholds.M&&['MM',months]||years===1&&['y']||['yy',years];args[2]=withoutSuffix;args[3]=+posNegDuration>0;args[4]=locale;return substituteTimeAgo.apply({},args);}
function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7;}
if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7;}
adjustedMoment=moment(mom).add(daysToDayOfWeek,'d');return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()};}
function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=makeUTCDate(year,0,1).getUTCDay(),daysToAdd,dayOfYear;d=d===0?7:d;weekday=weekday!=null?weekday:firstDayOfWeek;daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0);dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear};}
function makeMoment(config){var input=config._i,format=config._f;config._locale=config._locale||moment.localeData(config._l);if(input===null||(format===undefined&&input==='')){return moment.invalid({nullInput:true});}
if(typeof input==='string'){config._i=input=config._locale.preparse(input);}
if(moment.isMoment(input)){return new Moment(input,true);}else if(format){if(isArray(format)){makeDateFromStringAndArray(config);}else{makeDateFromStringAndFormat(config);}}else{makeDateFromInput(config);}
return new Moment(config);}
moment=function(input,format,locale,strict){var c;if(typeof(locale)==="boolean"){strict=locale;locale=undefined;}
c={};c._isAMomentObject=true;c._i=input;c._f=format;c._l=locale;c._strict=strict;c._isUTC=false;c._pf=defaultParsingFlags();return makeMoment(c);};moment.suppressDeprecationWarnings=false;moment.createFromInputFallback=deprecate('moment construction falls back to js Date. This is '+'discouraged and will be removed in upcoming major '+'release. Please refer to '+'https://github.com/moment/moment/issues/1407 for more info.',function(config){config._d=new Date(config._i);});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0];}
if(!moments.length){return moment();}
res=moments[0];for(i=1;i<moments.length;++i){if(moments[i][fn](res)){res=moments[i];}}
return res;}
moment.min=function(){var args=[].slice.call(arguments,0);return pickBy('isBefore',args);};moment.max=function(){var args=[].slice.call(arguments,0);return pickBy('isAfter',args);};moment.utc=function(input,format,locale,strict){var c;if(typeof(locale)==="boolean"){strict=locale;locale=undefined;}
c={};c._isAMomentObject=true;c._useUTC=true;c._isUTC=true;c._l=locale;c._i=input;c._f=format;c._strict=strict;c._pf=defaultParsingFlags();return makeMoment(c).utc();};moment.unix=function(input){return moment(input*1000);};moment.duration=function(input,key){var duration=input,match=null,sign,ret,parseIso,diffRes;if(moment.isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months};}else if(typeof input==='number'){duration={};if(key){duration[key]=input;}else{duration.milliseconds=input;}}else if(!!(match=aspNetTimeSpanJsonRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign};}else if(!!(match=isoDurationRegex.exec(input))){sign=(match[1]==='-')?-1:1;parseIso=function(inp){var res=inp&&parseFloat(inp.replace(',','.'));return(isNaN(res)?0:res)*sign;};duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])};}else if(typeof duration==='object'&&('from'in duration||'to'in duration)){diffRes=momentsDifference(moment(duration.from),moment(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months;}
ret=new Duration(duration);if(moment.isDuration(input)&&input.hasOwnProperty('_locale')){ret._locale=input._locale;}
return ret;};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.ISO_8601=function(){};moment.momentProperties=momentProperties;moment.updateOffset=function(){};moment.relativeTimeThreshold=function(threshold,limit){if(relativeTimeThresholds[threshold]===undefined){return false;}
if(limit===undefined){return relativeTimeThresholds[threshold];}
relativeTimeThresholds[threshold]=limit;return true;};moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value);});moment.locale=function(key,values){var data;if(key){if(typeof(values)!=="undefined"){data=moment.defineLocale(key,values);}
else{data=moment.localeData(key);}
if(data){moment.duration._locale=moment._locale=data;}}
return moment._locale._abbr;};moment.defineLocale=function(name,values){if(values!==null){values.abbr=name;if(!locales[name]){locales[name]=new Locale();}
locales[name].set(values);moment.locale(name);return locales[name];}else{delete locales[name];return null;}};moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key);});moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr;}
if(!key){return moment._locale;}
if(!isArray(key)){locale=loadLocale(key);if(locale){return locale;}
key=[key];}
return chooseLocale(key);};moment.isMoment=function(obj){return obj instanceof Moment||(obj!=null&&obj.hasOwnProperty('_isAMomentObject'));};moment.isDuration=function(obj){return obj instanceof Duration;};for(i=lists.length-1;i>=0;--i){makeList(lists[i]);}
moment.normalizeUnits=function(units){return normalizeUnits(units);};moment.invalid=function(flags){var m=moment.utc(NaN);if(flags!=null){extend(m._pf,flags);}
else{m._pf.userInvalidated=true;}
return m;};moment.parseZone=function(){return moment.apply(null,arguments).parseZone();};moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000);};extend(moment.fn=Moment.prototype,{clone:function(){return moment(this);},valueOf:function(){return+this._d+((this._offset||0)*60000);},unix:function(){return Math.floor(+this/1000);},toString:function(){return this.clone().locale('en').format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ");},toDate:function(){return this._offset?new Date(+this):this._d;},toISOString:function(){var m=moment(this).utc();if(0<m.year()&&m.year()<=9999){return formatMoment(m,'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');}else{return formatMoment(m,'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');}},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()];},isValid:function(){return isValid(this);},isDSTShifted:function(){if(this._a){return this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0;}
return false;},parsingFlags:function(){return extend({},this._pf);},invalidAt:function(){return this._pf.overflow;},utc:function(keepLocalTime){return this.zone(0,keepLocalTime);},local:function(keepLocalTime){if(this._isUTC){this.zone(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.add(this._d.getTimezoneOffset(),'m');}}
return this;},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output);},add:createAdder(1,'add'),subtract:createAdder(-1,'subtract'),diff:function(input,units,asFloat){var that=makeAs(input,this),zoneDiff=(this.zone()-that.zone())*6e4,diff,output;units=normalizeUnits(units);if(units==='year'||units==='month'){diff=(this.daysInMonth()+that.daysInMonth())*432e5;output=((this.year()-that.year())*12)+(this.month()-that.month());output+=((this-moment(this).startOf('month'))-
(that-moment(that).startOf('month')))/diff;output-=((this.zone()-moment(this).startOf('month').zone())-
(that.zone()-moment(that).startOf('month').zone()))*6e4/diff;if(units==='year'){output=output/12;}}else{diff=(this-that);output=units==='second'?diff/1e3:units==='minute'?diff/6e4:units==='hour'?diff/36e5:units==='day'?(diff-zoneDiff)/864e5:units==='week'?(diff-zoneDiff)/6048e5:diff;}
return asFloat?output:absRound(output);},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix);},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix);},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf('day'),diff=this.diff(sod,'days',true),format=diff<-6?'sameElse':diff<-1?'lastWeek':diff<0?'lastDay':diff<1?'sameDay':diff<2?'nextDay':diff<7?'nextWeek':'sameElse';return this.format(this.localeData().calendar(format,this));},isLeapYear:function(){return isLeapYear(this.year());},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone());},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,'d');}else{return day;}},month:makeAccessor('Month',true),startOf:function(units){units=normalizeUnits(units);switch(units){case'year':this.month(0);case'quarter':case'month':this.date(1);case'week':case'isoWeek':case'day':this.hours(0);case'hour':this.minutes(0);case'minute':this.seconds(0);case'second':this.milliseconds(0);}
if(units==='week'){this.weekday(0);}else if(units==='isoWeek'){this.isoWeekday(1);}
if(units==='quarter'){this.month(Math.floor(this.month()/3)*3);}
return this;},endOf:function(units){units=normalizeUnits(units);return this.startOf(units).add(1,(units==='isoWeek'?'week':units)).subtract(1,'ms');},isAfter:function(input,units){units=typeof units!=='undefined'?units:'millisecond';return+this.clone().startOf(units)>+moment(input).startOf(units);},isBefore:function(input,units){units=typeof units!=='undefined'?units:'millisecond';return+this.clone().startOf(units)<+moment(input).startOf(units);},isSame:function(input,units){units=units||'ms';return+this.clone().startOf(units)===+makeAs(input,this).startOf(units);},min:deprecate('moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548',function(other){other=moment.apply(null,arguments);return other<this?this:other;}),max:deprecate('moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548',function(other){other=moment.apply(null,arguments);return other>this?this:other;}),zone:function(input,keepLocalTime){var offset=this._offset||0,localAdjust;if(input!=null){if(typeof input==='string'){input=timezoneMinutesFromString(input);}
if(Math.abs(input)<16){input=input*60;}
if(!this._isUTC&&keepLocalTime){localAdjust=this._d.getTimezoneOffset();}
this._offset=input;this._isUTC=true;if(localAdjust!=null){this.subtract(localAdjust,'m');}
if(offset!==input){if(!keepLocalTime||this._changeInProgress){addOrSubtractDurationFromMoment(this,moment.duration(offset-input,'m'),1,false);}else if(!this._changeInProgress){this._changeInProgress=true;moment.updateOffset(this,true);this._changeInProgress=null;}}}else{return this._isUTC?offset:this._d.getTimezoneOffset();}
return this;},zoneAbbr:function(){return this._isUTC?'UTC':'';},zoneName:function(){return this._isUTC?'Coordinated Universal Time':'';},parseZone:function(){if(this._tzm){this.zone(this._tzm);}else if(typeof this._i==='string'){this.zone(this._i);}
return this;},hasAlignedHourOffset:function(input){if(!input){input=0;}
else{input=moment(input).zone();}
return(this.zone()-input)%60===0;},daysInMonth:function(){return daysInMonth(this.year(),this.month());},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf('day')-moment(this).startOf('year'))/864e5)+1;return input==null?dayOfYear:this.add((input-dayOfYear),'d');},quarter:function(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3);},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return input==null?year:this.add((input-year),'y');},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add((input-year),'y');},week:function(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,'d');},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,'d');},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,'d');},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7);},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4);},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy);},get:function(units){units=normalizeUnits(units);return this[units]();},set:function(units,value){units=normalizeUnits(units);if(typeof this[units]==='function'){this[units](value);}
return this;},locale:function(key){if(key===undefined){return this._locale._abbr;}else{this._locale=moment.localeData(key);return this;}},lang:deprecate("moment().lang() is deprecated. Use moment().localeData() instead.",function(key){if(key===undefined){return this.localeData();}else{this._locale=moment.localeData(key);return this;}}),localeData:function(){return this._locale;}});function rawMonthSetter(mom,value){var dayOfMonth;if(typeof value==='string'){value=mom.localeData().monthsParse(value);if(typeof value!=='number'){return mom;}}
dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d['set'+(mom._isUTC?'UTC':'')+'Month'](value,dayOfMonth);return mom;}
function rawGetter(mom,unit){return mom._d['get'+(mom._isUTC?'UTC':'')+unit]();}
function rawSetter(mom,unit,value){if(unit==='Month'){return rawMonthSetter(mom,value);}else{return mom._d['set'+(mom._isUTC?'UTC':'')+unit](value);}}
function makeAccessor(unit,keepTime){return function(value){if(value!=null){rawSetter(this,unit,value);moment.updateOffset(this,keepTime);return this;}else{return rawGetter(this,unit);}};}
moment.fn.millisecond=moment.fn.milliseconds=makeAccessor('Milliseconds',false);moment.fn.second=moment.fn.seconds=makeAccessor('Seconds',false);moment.fn.minute=moment.fn.minutes=makeAccessor('Minutes',false);moment.fn.hour=moment.fn.hours=makeAccessor('Hours',true);moment.fn.date=makeAccessor('Date',true);moment.fn.dates=deprecate('dates accessor is deprecated. Use date instead.',makeAccessor('Date',true));moment.fn.year=makeAccessor('FullYear',true);moment.fn.years=deprecate('years accessor is deprecated. Use year instead.',makeAccessor('FullYear',true));moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.quarters=moment.fn.quarter;moment.fn.toJSON=moment.fn.toISOString;function daysToYears(days){return days*400/146097;}
function yearsToDays(years){return years*146097/400;}
extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years=0;data.milliseconds=milliseconds%1000;seconds=absRound(milliseconds/1000);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);years=absRound(daysToYears(days));days-=absRound(yearsToDays(years));months+=absRound(days/30);days%=30;years+=absRound(months/12);months%=12;data.days=days;data.months=months;data.years=years;},abs:function(){this._milliseconds=Math.abs(this._milliseconds);this._days=Math.abs(this._days);this._months=Math.abs(this._months);this._data.milliseconds=Math.abs(this._data.milliseconds);this._data.seconds=Math.abs(this._data.seconds);this._data.minutes=Math.abs(this._data.minutes);this._data.hours=Math.abs(this._data.hours);this._data.months=Math.abs(this._data.months);this._data.years=Math.abs(this._data.years);return this;},weeks:function(){return absRound(this.days()/7);},valueOf:function(){return this._milliseconds+
this._days*864e5+
(this._months%12)*2592e6+
toInt(this._months/12)*31536e6;},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());if(withSuffix){output=this.localeData().pastFuture(+this,output);}
return this.localeData().postformat(output);},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this;},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this;},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+'s']();},as:function(units){var days,months;units=normalizeUnits(units);days=this._days+this._milliseconds/864e5;if(units==='month'||units==='year'){months=this._months+daysToYears(days)*12;return units==='month'?months:months/12;}else{days+=yearsToDays(this._months/12);switch(units){case'week':return days/7;case'day':return days;case'hour':return days*24;case'minute':return days*24*60;case'second':return days*24*60*60;case'millisecond':return days*24*60*60*1000;default:throw new Error('Unknown unit '+units);}}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead "+"(notice the capitals)",function(){return this.toISOString();}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1000);if(!this.asSeconds()){return'P0D';}
return(this.asSeconds()<0?'-':'')+'P'+
(years?years+'Y':'')+
(months?months+'M':'')+
(days?days+'D':'')+
((hours||minutes||seconds)?'T':'')+
(hours?hours+'H':'')+
(minutes?minutes+'M':'')+
(seconds?seconds+'S':'');},localeData:function(){return this._locale;}});function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name];};}
for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationGetter(i.toLowerCase());}}
moment.duration.fn.asMilliseconds=function(){return this.as('ms');};moment.duration.fn.asSeconds=function(){return this.as('s');};moment.duration.fn.asMinutes=function(){return this.as('m');};moment.duration.fn.asHours=function(){return this.as('h');};moment.duration.fn.asDays=function(){return this.as('d');};moment.duration.fn.asWeeks=function(){return this.as('weeks');};moment.duration.fn.asMonths=function(){return this.as('M');};moment.duration.fn.asYears=function(){return this.as('y');};moment.locale('en',{ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?'th':(b===1)?'st':(b===2)?'nd':(b===3)?'rd':'th';return number+output;}});function makeGlobal(shouldDeprecate){if(typeof ender!=='undefined'){return;}
oldGlobalMoment=globalScope.moment;if(shouldDeprecate){globalScope.moment=deprecate('Accessing Moment through the global scope is '+'deprecated, and will be removed in an upcoming '+'release.',moment);}else{globalScope.moment=moment;}}
if(hasModule){module.exports=moment;}else if(typeof define==='function'&&define.amd){define('moment',function(require,exports,module){if(module.config&&module.config()&&module.config().noGlobal===true){globalScope.moment=oldGlobalMoment;}
return moment;});makeGlobal(true);}else{makeGlobal();}}).call(this);;

/* /web/static/src/js/odoo_supportframework.js defined in bundle 'odoo_support_livechat.odoo_livechat_external_assets' */
(function(){"use strict";function declare($,_,QWeb2){var odoo_support={};(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz();})?/\b_super\b/:/.*/;odoo_support.Class=function(){};odoo_support.Class.extend=function(){var _super=this.prototype;var args=_.toArray(arguments);args.unshift({});var prop=_.extend.apply(_,args);initializing=true;var This=this;var prototype=new This();initializing=false;_.each(prop,function(val,name){prototype[name]=typeof prop[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,prop[name]):prop[name];});function Class(){if(this.constructor!==odoo_support.Class){throw new Error("You can only instanciate objects with the 'new' operator");}
this._super=null;if(!initializing&&this.init){var ret=this.init.apply(this,arguments);if(ret){return ret;}}
return this;}
Class.include=function(properties){_.each(properties,function(val,name){if(typeof properties[name]!=='function'||!fnTest.test(properties[name])){prototype[name]=properties[name];}else if(typeof prototype[name]==='function'&&prototype.hasOwnProperty(name)){prototype[name]=(function(name,fn,previous){return function(){var tmp=this._super;this._super=previous;var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,properties[name],prototype[name]);}else if(typeof _super[name]==='function'){prototype[name]=(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,properties[name]);}});};Class.prototype=prototype;Class.constructor=Class;Class.extend=this.extend;return Class;};})();odoo_support.ParentedMixin={__parentedMixin:true,init:function(){this.__parentedDestroyed=false;this.__parentedChildren=[];this.__parentedParent=null;},setParent:function(parent){if(this.getParent()){if(this.getParent().__parentedMixin){this.getParent().__parentedChildren=_.without(this.getParent().getChildren(),this);}}
this.__parentedParent=parent;if(parent&&parent.__parentedMixin){parent.__parentedChildren.push(this);}},getParent:function(){return this.__parentedParent;},getChildren:function(){return _.clone(this.__parentedChildren);},isDestroyed:function(){return this.__parentedDestroyed;},alive:function(promise,reject){var self=this;return $.Deferred(function(def){promise.then(function(){if(!self.isDestroyed()){def.resolve.apply(def,arguments);}},function(){if(!self.isDestroyed()){def.reject.apply(def,arguments);}}).always(function(){if(reject){def.reject();}});}).promise();},destroy:function(){_.each(this.getChildren(),function(el){el.destroy();});this.setParent(undefined);this.__parentedDestroyed=true;},findAncestor:function(predicate){var ancestor=this;while(!(predicate(ancestor))&&ancestor&&ancestor.getParent){ancestor=ancestor.getParent();}
return ancestor;},};var Events=odoo_support.Class.extend({on:function(events,callback,context){var ev;events=events.split(/\s+/);var calls=this._callbacks||(this._callbacks={});while((ev=events.shift())){var list=calls[ev]||(calls[ev]={});var tail=list.tail||(list.tail=list.next={});tail.callback=callback;tail.context=context;list.tail=tail.next={};}
return this;},off:function(events,callback,context){var ev,calls,node;if(!events){delete this._callbacks;}else if((calls=this._callbacks)){events=events.split(/\s+/);while((ev=events.shift())){node=calls[ev];delete calls[ev];if(!callback||!node)
continue;while((node=node.next)&&node.next){if(node.callback===callback&&(!context||node.context===context))
continue;this.on(ev,node.callback,node.context);}}}
return this;},callbackList:function(){var lst=[];_.each(this._callbacks||{},function(el,eventName){var node=el;while((node=node.next)&&node.next){lst.push([eventName,node.callback,node.context]);}});return lst;},trigger:function(events){var event,node,calls,tail,args,all,rest;if(!(calls=this._callbacks))
return this;all=calls['all'];(events=events.split(/\s+/)).push(null);while((event=events.shift())){if(all)
events.push({next:all.next,tail:all.tail,event:event});if(!(node=calls[event]))
continue;events.push({next:node.next,tail:node.tail});}
rest=Array.prototype.slice.call(arguments,1);while((node=events.pop())){tail=node.tail;args=node.event?[node.event].concat(rest):rest;while((node=node.next)!==tail){node.callback.apply(node.context||this,args);}}
return this;}});odoo_support.EventDispatcherMixin=_.extend({},odoo_support.ParentedMixin,{__eventDispatcherMixin:true,init:function(){odoo_support.ParentedMixin.init.call(this);this.__edispatcherEvents=new Events();this.__edispatcherRegisteredEvents=[];},on:function(events,dest,func){var self=this;if(typeof func!=="function"){throw new Error("Event handler must be a function.");}
events=events.split(/\s+/);_.each(events,function(eventName){self.__edispatcherEvents.on(eventName,func,dest);if(dest&&dest.__eventDispatcherMixin){dest.__edispatcherRegisteredEvents.push({name:eventName,func:func,source:self});}});return this;},off:function(events,dest,func){var self=this;events=events.split(/\s+/);_.each(events,function(eventName){self.__edispatcherEvents.off(eventName,func,dest);if(dest&&dest.__eventDispatcherMixin){dest.__edispatcherRegisteredEvents=_.filter(dest.__edispatcherRegisteredEvents,function(el){return!(el.name===eventName&&el.func===func&&el.source===self);});}});return this;},trigger:function(events){this.__edispatcherEvents.trigger.apply(this.__edispatcherEvents,arguments);return this;},destroy:function(){var self=this;_.each(this.__edispatcherRegisteredEvents,function(event){event.source.__edispatcherEvents.off(event.name,event.func,self);});this.__edispatcherRegisteredEvents=[];_.each(this.__edispatcherEvents.callbackList(),function(cal){this.off(cal[0],cal[2],cal[1]);},this);this.__edispatcherEvents.off();odoo_support.ParentedMixin.destroy.call(this);}});odoo_support.PropertiesMixin=_.extend({},odoo_support.EventDispatcherMixin,{init:function(){odoo_support.EventDispatcherMixin.init.call(this);this.__getterSetterInternalMap={};},set:function(arg1,arg2,arg3){var map;var options;if(typeof arg1==="string"){map={};map[arg1]=arg2;options=arg3||{};}else{map=arg1;options=arg2||{};}
var self=this;var changed=false;_.each(map,function(val,key){var tmp=self.__getterSetterInternalMap[key];if(tmp===val)
return;if(key==='value'&&self.field&&self.field.type==='float'&&tmp&&val){var digits=self.field.digits;if(digits!==0){digits=digits?digits[1]:2;if(odoo_support.web.float_is_zero(tmp-val,digits)){return;}}}
changed=true;self.__getterSetterInternalMap[key]=val;if(!options.silent)
self.trigger("change:"+key,self,{oldValue:tmp,newValue:val});});if(changed)
self.trigger("change",self);},get:function(key){return this.__getterSetterInternalMap[key];}});odoo_support.Widget=odoo_support.Class.extend(odoo_support.PropertiesMixin,{tagName:'div',id:null,className:null,attributes:{},events:{},template:null,init:function(parent){odoo_support.PropertiesMixin.init.call(this);this.setParent(parent);for(var name in this){if(typeof(this[name])=="function"){if((/^on_|^do_/).test(name)){this[name]=_.bind(this[name],this);}}}
this.setElement(this._make_descriptive());},destroy:function(){_.each(this.getChildren(),function(el){el.destroy();});if(this.$el){this.$el.remove();}
odoo_support.PropertiesMixin.destroy.call(this);},appendTo:function(target){var self=this;return this.__widgetRenderAndInsert(function(t){self.$el.appendTo(t);},target);},prependTo:function(target){var self=this;return this.__widgetRenderAndInsert(function(t){self.$el.prependTo(t);},target);},insertAfter:function(target){var self=this;return this.__widgetRenderAndInsert(function(t){self.$el.insertAfter(t);},target);},insertBefore:function(target){var self=this;return this.__widgetRenderAndInsert(function(t){self.$el.insertBefore(t);},target);},replace:function(target){return this.__widgetRenderAndInsert(_.bind(function(t){this.$el.replaceAll(t);},this),target);},__widgetRenderAndInsert:function(insertion,target){this.renderElement();insertion(target);return this.start();},start:function(){return $.when();},renderElement:function(){var $el;if(this.template){$el=$(odoo_support.qweb.render(this.template,{widget:this}).trim());}else{$el=this._make_descriptive();}
this.replaceElement($el);},replaceElement:function($el){var $oldel=this.$el;this.setElement($el);if($oldel&&!$oldel.is(this.$el)){if($oldel.length>1){$oldel.wrapAll('<div/>');$oldel.parent().replaceWith(this.$el);}else{$oldel.replaceWith(this.$el);}}
return this;},setElement:function(element){if(this.$el){this.undelegateEvents();}
this.$el=(element instanceof $)?element:$(element);this.el=this.$el[0];this.delegateEvents();return this;},make:function(tagName,attributes,content){var el=document.createElement(tagName);if(!_.isEmpty(attributes)){$(el).attr(attributes);}
if(content){$(el).html(content);}
return el;},_make_descriptive:function(){var attrs=_.extend({},this.attributes||{});if(this.id){attrs.id=this.id;}
if(this.className){attrs['class']=this.className;}
return $(this.make(this.tagName,attrs));},delegateEvents:function(){var events=this.events;if(_.isEmpty(events)){return;}
for(var key in events){if(!events.hasOwnProperty(key)){continue;}
var method=this.proxy(events[key]);var match=/^(\S+)(\s+(.*))?$/.exec(key);var event=match[1];var selector=match[3];event+='.widget_events';if(!selector){this.$el.on(event,method);}else{this.$el.on(event,selector,method);}}},undelegateEvents:function(){this.$el.off('.widget_events');},$:function(selector){if(selector===undefined)
return this.$el;return this.$el.find(selector);},do_show:function(){this.$el.show();},do_hide:function(){this.$el.hide();},proxy:function(method){var self=this;return function(){var fn=(typeof method==='string')?self[method]:method;return fn.apply(self,arguments);};}});var genericJsonRpc=function(fct_name,params,fct){var data={jsonrpc:"2.0",method:fct_name,params:params,id:Math.floor(Math.random()*1000*1000*1000)};var xhr=fct(data);var result=xhr.pipe(function(result){if(result.error!==undefined){console.error("Server application error",result.error);return $.Deferred().reject("server",result.error);}else{return result.result;}},function(){var def=$.Deferred();return def.reject.apply(def,["communication"].concat(_.toArray(arguments)));});result.abort=function(){xhr.abort&&xhr.abort();};return result;};function date_to_utc(k,v){var value=this[k];if(!(value instanceof Date)){return v;}
return odoo_support.datetime_to_str(value);}
odoo_support.jsonRpc=function(url,fct_name,params,settings){return genericJsonRpc(fct_name,params,function(data){return $.ajax(url,_.extend({},settings,{url:url,dataType:'json',type:'POST',data:JSON.stringify(data,date_to_utc),contentType:'application/json'}));});};odoo_support.jsonpRpc=function(url,fct_name,params,settings){settings=settings||{};return genericJsonRpc(fct_name,params,function(data){var payload_str=JSON.stringify(data,date_to_utc);var payload_url=$.param({r:payload_str});var force2step=settings.force2step||false;delete settings.force2step;var session_id=settings.session_id||null;delete settings.session_id;if(payload_url.length<2000&&!force2step){return $.ajax(url,_.extend({},settings,{url:url,dataType:'jsonp',jsonp:'jsonp',type:'GET',cache:false,data:{r:payload_str,session_id:session_id}}));}else{var args={session_id:session_id,id:data.id};var ifid=_.uniqueId('oe_rpc_iframe');var html="<iframe src='javascript:false;' name='"+ifid+"' id='"+ifid+"' style='display:none'></iframe>";var $iframe=$(html);var nurl='jsonp=1&'+$.param(args);nurl=url.indexOf("?")!==-1?url+"&"+nurl:url+"?"+nurl;var $form=$('<form>').attr('method','POST').attr('target',ifid).attr('enctype',"multipart/form-data").attr('action',nurl).append($('<input type="hidden" name="r" />').attr('value',payload_str)).hide().appendTo($('body'));var cleanUp=function(){if($iframe){$iframe.unbind("load").remove();}
$form.remove();};var deferred=$.Deferred();$iframe.bind('load',function(){$iframe.unbind('load').bind('load',function(){$.ajax({url:url,dataType:'jsonp',jsonp:'jsonp',type:'GET',cache:false,data:{session_id:session_id,id:data.id}}).always(function(){cleanUp();}).done(function(){deferred.resolve.apply(deferred,arguments);}).fail(function(){deferred.reject.apply(deferred,arguments);});});$form.submit();});$form.after($iframe);if(settings.timeout){realSetTimeout(function(){deferred.reject({});},settings.timeout);}
return deferred;}});};odoo_support.loadCSS=function(url){if(!$('link[href="'+url+'"]').length){$('head').append($('<link>',{'href':url,'rel':'stylesheet','type':'text/css'}));}};odoo_support.loadJS=function(url){var def=$.Deferred();if($('script[src="'+url+'"]').length){def.resolve();}else{var script=document.createElement('script');script.type='text/javascript';script.src=url;script.onload=script.onreadystatechange=function(){if((script.readyState&&script.readyState!="loaded"&&script.readyState!="complete")||script.onload_done){return;}
script.onload_done=true;def.resolve(url);};script.onerror=function(){console.error("Error loading file",script.src);def.reject(url);};var head=document.head||document.getElementsByTagName('head')[0];head.appendChild(script);}
return def;};odoo_support.loadBundle=function(name){return $.when(odoo_support.loadCSS('/web/css/'+name),odoo_support.loadJS('/web/js/'+name));};var realSetTimeout=function(fct,millis){var finished=new Date().getTime()+millis;var wait=function(){var current=new Date().getTime();if(current<finished){setTimeout(wait,finished-current);}else{fct();}};setTimeout(wait,millis);};odoo_support.Session=odoo_support.Class.extend(odoo_support.PropertiesMixin,{triggers:{'request':'Request sent','response':'Response received','response_failed':'HTTP Error response or timeout received','error':'The received response is an JSON-RPC error'},init:function(parent,origin,options){odoo_support.PropertiesMixin.init.call(this,parent);options=options||{};this.server=null;this.session_id=options.session_id||null;this.override_session=options.override_session||!!options.session_id||false;this.avoid_recursion=false;this.use_cors=options.use_cors||false;this.setup(origin);},setup:function(origin){var window_origin=location.protocol+"//"+location.host;origin=origin?origin.replace(/\/+$/,''):window_origin;if(!_.isUndefined(this.origin)&&this.origin!==origin)
throw new Error('Session already bound to '+this.origin);else
this.origin=origin;this.prefix=this.origin;this.server=this.origin;this.origin_server=this.origin===window_origin;},session_reload:function(){var self=this;return self.rpc("/web/session/get_session_info",{}).then(function(result){delete result.session_id;_.extend(self,result);});},session_authenticate:function(db,login,password){var self=this;var params={db:db,login:login,password:password};return this.rpc("/web/session/authenticate",params).then(function(result){if(!result.uid){return $.Deferred().reject();}
delete result.session_id;_.extend(self,result);});},check_session_id:function(){var self=this;if(this.avoid_recursion)
return $.when();if(this.session_id)
return $.when();if(!this.use_cors&&(this.override_session||!this.origin_server)){this.avoid_recursion=true;return this.rpc("/gen_session_id",{}).then(function(result){self.session_id=result;}).always(function(){self.avoid_recursion=false;});}else{self.session_id=odoo_support.get_cookie("session_id");return $.when();}},rpc:function(url,params,options){var self=this;options=_.clone(options||{});var shadow=options.shadow||false;delete options.shadow;return self.check_session_id().then(function(){if(!_.isString(url)){_.extend(options,url);url=url.url;}
if(!shadow)
self.trigger('request');var fct;if(self.origin_server){fct=odoo_support.jsonRpc;if(self.override_session){options.headers=_.extend({},options.headers,{"X-Openerp-Session-Id":self.override_session?self.session_id||'':''});}}else if(self.use_cors){fct=odoo_support.jsonRpc;url=self.url(url,null);options.session_id=self.session_id||'';if(self.override_session){options.headers=_.extend({},options.headers,{"X-Openerp-Session-Id":self.override_session?self.session_id||'':''});}}else{fct=odoo_support.jsonpRpc;url=self.url(url,null);options.session_id=self.session_id||'';}
var p=fct(url,"call",params,options);p=p.then(function(result){if(!shadow)
self.trigger('response');return result;},function(type,error,textStatus,errorThrown){if(type==="server"){if(!shadow)
self.trigger('response');if(error.code===100){self.uid=false;}
return $.Deferred().reject(error,$.Event());}else{if(!shadow)
self.trigger('response_failed');var nerror={code:-32098,message:"XmlHttpRequestError "+errorThrown,data:{type:"xhr"+textStatus,debug:error.responseText,objects:[error,errorThrown]}};return $.Deferred().reject(nerror,$.Event());}});return p.fail(function(){p.fail(function(error,event){if(!event.isDefaultPrevented()){self.trigger('error',error,event);}});});});},url:function(path,params){params=_.extend(params||{});if(this.override_session||(!this.origin_server))
params.session_id=this.session_id;var qs=$.param(params);if(qs.length>0)
qs="?"+qs;var prefix=_.any(['http://','https://','//'],function(el){return path.length>=el.length&&path.slice(0,el.length)===el;})?'':this.prefix;return prefix+path+qs;},model:function(model_name){return new odoo_support.Model(this,model_name);}});odoo_support.Model=odoo_support.Class.extend({init:function(){var session,model_name;var args=_.toArray(arguments);args.reverse();session=args.pop();if(session&&!(session instanceof odoo_support.Session)){model_name=session;session=null;}else{model_name=args.pop();}
this.name=model_name;this._session=session;},session:function(){if(!this._session)
throw new Error("Not session specified");return this._session;},call:function(method,args,kwargs,options){args=args||[];kwargs=kwargs||{};if(!_.isArray(args)){kwargs=args;args=[];}
var call_kw='/web/dataset/call_kw/'+this.name+'/'+method;return this.session().rpc(call_kw,{model:this.name,method:method,args:args,kwargs:kwargs},options);}});odoo_support.TranslationDataBase=odoo_support.Class.extend({init:function(){this.db={};this.parameters={"direction":'ltr',"date_format":'%m/%d/%Y',"time_format":'%H:%M:%S',"grouping":[],"decimal_point":".","thousands_sep":","};},set_bundle:function(translation_bundle){var self=this;this.db={};var modules=_.keys(translation_bundle.modules);modules.sort();if(_.include(modules,"web")){modules=["web"].concat(_.without(modules,"web"));}
_.each(modules,function(name){self.add_module_translation(translation_bundle.modules[name]);});if(translation_bundle.lang_parameters){this.parameters=translation_bundle.lang_parameters;}},add_module_translation:function(mod){var self=this;_.each(mod.messages,function(message){self.db[message.id]=message.string;});},build_translation_function:function(){var self=this;var fcnt=function(str){var tmp=self.get(str);return tmp===undefined?str:tmp;};fcnt.database=this;return fcnt;},get:function(key){return this.db[key];},load_translations:function(session,modules,lang){var self=this;return session.rpc('/web/webclient/translations',{"mods":modules||null,"lang":lang||null}).done(function(trans){self.set_bundle(trans);});}});odoo_support._t=new odoo_support.TranslationDataBase().build_translation_function();odoo_support.get_cookie=function(c_name){var cookies=document.cookie?document.cookie.split('; '):[];for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=parts.shift();var cookie=parts.join('=');if(c_name&&c_name===name){return cookie;}}
return"";};odoo_support.qweb=new QWeb2.Engine();odoo_support.qweb.default_dict={'_':_,'JSON':JSON,'_t':odoo_support._t};odoo_support.Mutex=odoo_support.Class.extend({init:function(){this.def=$.Deferred().resolve();},exec:function(action){var current=this.def;var next=this.def=$.Deferred();return current.then(function(){return $.when(action()).always(function(){next.resolve();});});}});odoo_support.str_to_datetime=function(str){if(!str){return str;}
var regex=/^(\d\d\d\d)-(\d\d)-(\d\d) (\d\d):(\d\d):(\d\d(?:\.(\d+))?)$/;var res=regex.exec(str);if(!res){throw new Error("'"+str+"' is not a valid datetime");}
var tmp=new Date(2000,0,1);tmp.setUTCMonth(1970);tmp.setUTCMonth(0);tmp.setUTCDate(1);tmp.setUTCFullYear(parseFloat(res[1]));tmp.setUTCMonth(parseFloat(res[2])-1);tmp.setUTCDate(parseFloat(res[3]));tmp.setUTCHours(parseFloat(res[4]));tmp.setUTCMinutes(parseFloat(res[5]));tmp.setUTCSeconds(parseFloat(res[6]));tmp.setUTCSeconds(parseFloat(res[6]));tmp.setUTCMilliseconds(parseFloat(rpad((res[7]||"").slice(0,3),3)));return tmp;};odoo_support.str_to_date=function(str){if(!str){return str;}
var regex=/^(\d\d\d\d)-(\d\d)-(\d\d)$/;var res=regex.exec(str);if(!res){throw new Error("'"+str+"' is not a valid date");}
var tmp=new Date(2000,0,1);tmp.setFullYear(parseFloat(res[1]));tmp.setMonth(parseFloat(res[2])-1);tmp.setDate(parseFloat(res[3]));tmp.setHours(0);tmp.setMinutes(0);tmp.setSeconds(0);return tmp;};odoo_support.str_to_time=function(str){if(!str){return str;}
var regex=/^(\d\d):(\d\d):(\d\d(?:\.(\d+))?)$/;var res=regex.exec(str);if(!res){throw new Error("'"+str+"' is not a valid time");}
var tmp=new Date();tmp.setFullYear(1970);tmp.setMonth(0);tmp.setDate(1);tmp.setHours(parseFloat(res[1]));tmp.setMinutes(parseFloat(res[2]));tmp.setSeconds(parseFloat(res[3]));tmp.setMilliseconds(parseFloat(rpad((res[4]||"").slice(0,3),3)));return tmp;};var lpad=function(str,size){str=""+str;return new Array(size-str.length+1).join('0')+str;};var rpad=function(str,size){str=""+str;return str+new Array(size-str.length+1).join('0');};odoo_support.datetime_to_str=function(obj){if(!obj){return false;}
return lpad(obj.getUTCFullYear(),4)+"-"+lpad(obj.getUTCMonth()+1,2)+"-"
+lpad(obj.getUTCDate(),2)+" "+lpad(obj.getUTCHours(),2)+":"
+lpad(obj.getUTCMinutes(),2)+":"+lpad(obj.getUTCSeconds(),2);};odoo_support.date_to_str=function(obj){if(!obj){return false;}
return lpad(obj.getFullYear(),4)+"-"+lpad(obj.getMonth()+1,2)+"-"
+lpad(obj.getDate(),2);};odoo_support.time_to_str=function(obj){if(!obj){return false;}
return lpad(obj.getHours(),2)+":"+lpad(obj.getMinutes(),2)+":"
+lpad(obj.getSeconds(),2);};jQuery.expr[":"].Contains=jQuery.expr.createPseudo(function(arg){return function(elem){return jQuery(elem).text().toUpperCase().indexOf(arg.toUpperCase())>=0;};});odoo_support.declare=declare;return odoo_support;}
if(typeof(define)!=="undefined"){define(["jquery","underscore","qweb2"],declare);}else{window.odoo_support=declare($,_,QWeb2);}})();;

/* /bus/static/src/js/bus.js defined in bundle 'odoo_support_livechat.odoo_livechat_external_assets' */
(function(){var bus=odoo_support.bus={};bus.ERROR_DELAY=10000;bus.Bus=odoo_support.Widget.extend({init:function(){this._super();this.options={};this.activated=false;this.channels=[];this.last=0;this.stop=false;},start_polling:function(){if(!this.activated){this.poll();this.stop=false;}},stop_polling:function(){this.activated=false;this.stop=true;this.channels=[];},poll:function(){var self=this;self.activated=true;var data={'channels':self.channels,'last':self.last,'options':self.options};odoo_support.session.rpc('/longpolling/poll',data,{shadow:true}).then(function(result){_.each(result,_.bind(self.on_notification,self));if(!self.stop){self.poll();}},function(unused,e){e.preventDefault();setTimeout(_.bind(self.poll,self),bus.ERROR_DELAY+(Math.floor((Math.random()*20)+1)*1000));});},on_notification:function(notification){if(notification.id>this.last){this.last=notification.id;}
this.trigger("notification",[notification.channel,notification.message]);},add_channel:function(channel){if(!_.contains(this.channels,channel)){this.channels.push(channel);}},delete_channel:function(channel){this.channels=_.without(this.channels,channel);},});bus.bus=new bus.Bus();return bus;})();;

/* /im_chat/static/src/js/im_chat.js defined in bundle 'odoo_support_livechat.odoo_livechat_external_assets' */
(function(){"use strict";var _t=odoo_support._t;var _lt=odoo_support._lt;var QWeb=odoo_support.qweb;var NBR_LIMIT_HISTORY=20;var USERS_LIMIT=20;var im_chat=odoo_support.im_chat={};im_chat.ConversationManager=odoo_support.Widget.extend({init:function(parent,options){var self=this;this._super(parent);this.options=_.clone(options)||{};_.defaults(this.options,{inputPlaceholder:_t("Say something..."),defaultMessage:null,defaultUsername:_t("Visitor"),});this.sessions={};this.bus=odoo_support.bus.bus;this.bus.on("notification",this,this.on_notification);this.bus.options["im_presence"]=true;this.set("right_offset",0);this.set("bottom_offset",0);this.on("change:right_offset",this,this.calc_positions);this.on("change:bottom_offset",this,this.calc_positions);this.set("window_focus",true);this.on("change:window_focus",self,function(e){self.bus.options["im_presence"]=self.get("window_focus");});this.set("waiting_messages",0);this.on("change:waiting_messages",this,this.window_title_change);$(window).on("focus",_.bind(this.window_focus,this));$(window).on("blur",_.bind(this.window_blur,this));this.window_title_change();},on_notification:function(notification){var self=this;var channel=notification[0];var message=notification[1];var regex_uuid=new RegExp(/(\w{8}(-\w{4}){3}-\w{12}?)/g);if((Array.isArray(channel)&&(channel[1]==='im_chat.session'||channel[1]==='im_chat.presence'))||(regex_uuid.test(channel))){if(message.type==="message"||message.type==="meta"){self.received_message(message);}
if(message.uuid){this.apply_session(message);}
if(message.im_status){self.trigger("im_new_user_status",[message]);}}},window_focus:function(){this.set("window_focus",true);this.set("waiting_messages",0);},window_blur:function(){this.set("window_focus",false);},window_beep:function(){if(typeof(Audio)==="undefined"){return;}
var audio=new Audio();var ext=audio.canPlayType("audio/ogg; codecs=vorbis")?".ogg":".mp3";var kitten=jQuery.deparam!==undefined&&jQuery.deparam(jQuery.param.querystring()).kitten!==undefined;audio.src=odoo_support.session.url("/im_chat/static/src/audio/"+(kitten?"purr":"ting")+ext);audio.play();},window_title_change:function(){var title=undefined;if(this.get("waiting_messages")!==0){title=_.str.sprintf(_t("%d Messages"),this.get("waiting_messages"))
this.window_beep();}
if(!odoo_support.webclient||!odoo_support.webclient.set_title_part)
return;odoo_support.webclient.set_title_part("im_messages",title);},apply_session:function(session,focus){var self=this;var conv=this.sessions[session.uuid];if(!conv){if(session.state!=='closed'){conv=new im_chat.Conversation(this,this,session,this.options);conv.appendTo($("body"));conv.on("destroyed",this,_.bind(this.delete_session,this));this.sessions[session.uuid]=conv;this.calc_positions();}}else{conv.set("session",session);}
conv&&this.trigger("im_session_activated",conv);if(focus)
conv.focus();return conv;},activate_session:function(session,focus){var self=this;var active_session=_.clone(session);active_session.state='open';var conv=this.apply_session(active_session,focus);if(session.state!=='open'){conv.update_fold_state('open');}
return conv;},delete_session:function(uuid){delete this.sessions[uuid];this.calc_positions();},received_message:function(message){var self=this;var session_id=message.to_id[0];var uuid=message.to_id[1];var from_id=message['from_id']?message['from_id'][0]:false;var current_user=odoo_support.session?odoo_support.session.uid:false;if(!this.get("window_focus")&&from_id!=current_user){this.set("waiting_messages",this.get("waiting_messages")+1);}
var conv=this.sessions[uuid];if(!conv){var def_session=new odoo_support.Model("im_chat.session").call("session_info",[],{"ids":[session_id]}).then(function(session){conv=self.activate_session(session,false);conv.received_message(message);});}else{conv.received_message(message);}},calc_positions:function(){var self=this;var current=this.get("right_offset");_.each(this.sessions,function(s){s.set("bottom_position",self.get("bottom_offset"));s.set("right_position",current);current+=s.$().outerWidth(true);});},destroy:function(){$(window).off("unload",this.unload);$(window).off("focus",this.window_focus);$(window).off("blur",this.window_blur);return this._super();}});im_chat.Conversation=odoo_support.Widget.extend({className:"odoo_support_style oe_im_chatview",events:{"keydown input":"keydown","click .oe_im_chatview_options":"click_options","click .oe_im_chatview_close":"click_close","click .oe_im_chatview_header":"click_header"},init:function(parent,c_manager,session,options){this._super(parent);this.c_manager=c_manager;this.options=options||{};this.loading_history=true;this.set("messages",[]);this.set("session",session);this.set("right_position",0);this.set("bottom_position",0);this.set("pending",0);this.inputPlaceholder=this.options.defaultInputPlaceholder;},start:function(){var self=this;self.$().append(odoo_support.qweb.render("im_chat.Conversation",{widget:self}));self.$().hide();self.on("change:session",self,self.update_session);self.on("change:right_position",self,self.calc_pos);self.on("change:bottom_position",self,self.calc_pos);self.full_height=self.$().height();self.calc_pos();self.on("change:pending",self,_.bind(function(){if(self.get("pending")===0){self.$(".oe_im_chatview_nbr_messages").text("");}else{self.$(".oe_im_chatview_nbr_messages").text("("+self.get("pending")+")");}},self));self.on("change:messages",this,this.render_messages);self.$('.oe_im_chatview_content').on('scroll',function(){if($(this).scrollTop()===0){self.load_history();}});self.load_history();self.$().show();self.update_session();self.init_options();},init_options:function(){this.define_options();if(this.$('.oe_im_chatview_option_list li').length===0){this.$('.oe_im_chatview_option_group').hide();}},define_options:function(){this._add_option("Shortcuts","option_shortcut","fa fa-info-circle");this.$('.oe_im_chatview_option_list .option_shortcut').on('click',_.bind(this.click_option_shortcut,this));this._add_option('Quit discussion','im_chat_option_quit','fa fa-minus-square');this.$('.oe_im_chatview_option_list .im_chat_option_quit').on('click',this,_.bind(this.action_quit_conversation,this));},_add_option:function(label,style_class,icon_fa_class){if(icon_fa_class){label='<i class="'+icon_fa_class+'"></i> '+label;}
this.$('.oe_im_chatview_option_list').append('<li class="'+style_class+'">'+label+'</li>');},action_quit_conversation:function(){var self=this;var Session=new odoo_support.Model("im_chat.session");return Session.call("quit_user",[this.get("session").uuid]).then(function(res){if(!res){odoo_support.client.do_warn(_t("Warning"),_t("You are only 2 identified users. Just close the conversation to leave."));}});},show:function(){this.$().animate({height:this.full_height});this.set("pending",0);},hide:function(){this.$().animate({height:this.$(".oe_im_chatview_header").outerHeight()});},calc_pos:function(){this.$().css("right",this.get("right_position"));this.$().css("bottom",this.get("bottom_position"));},update_fold_state:function(state){return new odoo_support.Model("im_chat.session").call("update_state",[],{"uuid":this.get("session").uuid,"state":state});},update_session:function(){var names=[];_.each(this.get("session").users,function(user){if((odoo_support.session.uid!==user.id)&&!(_.isUndefined(odoo_support.session.uid)&&!user.id)){names.push(user.name);}});this.$(".oe_im_chatview_header_name").text(names.join(", "));this.$(".oe_im_chatview_header_name").attr('title',names.join(", "));if(this.get("session").state){if(this.get("session").state==='closed'){this.destroy();}else{if(this.get("session").state==='open'){this.show();}else{this.hide();}}}},load_history:function(){var self=this;if(this.loading_history){var data={uuid:self.get("session").uuid,limit:NBR_LIMIT_HISTORY};var lastid=_.first(this.get("messages"))?_.first(this.get("messages")).id:false;if(lastid){data["last_id"]=lastid;}
odoo_support.session.rpc("/im_chat/history",data).then(function(messages){if(messages){self.insert_messages(messages);if(messages.length!=NBR_LIMIT_HISTORY){self.loading_history=false;}}else{self.loading_history=false;}});}},received_message:function(message){if(this.get('session').state==='open'){this.set("pending",0);}else{this.set("pending",this.get("pending")+1);}
this.insert_messages([message]);this._go_bottom();},send_message:function(message,type){var self=this;var send_it=function(){return odoo_support.session.rpc("/im_chat/post",{uuid:self.get("session").uuid,message_type:type,message_content:message});};var tries=0;send_it().fail(function(error,e){e.preventDefault();tries+=1;if(tries<3)
return send_it();});},insert_messages:function(messages){var self=this;var get_anonymous_name=function(){var name=self.options["defaultUsername"];_.each(self.get('session').users,function(u){if(!u.id){name=u.name;}});return name;};messages=_.filter(messages,function(m){return!_.contains(_.pluck(self.get("messages"),'id'),m.id);});_.map(messages,function(m){if(!m.from_id){m.from_id=[false,get_anonymous_name()];}
m.create_date=moment(odoo_support.str_to_datetime(m.create_date)).format('YYYY-MM-DD HH:mm:ss');return m;});this.set("messages",_.sortBy(this.get("messages").concat(messages),function(m){return m.id;}));},render_messages:function(){var self=this;var res={};var last_date_day,last_user_id=-1;_.each(this.get("messages"),function(current){current.from_id[2]=odoo_support.session.url(_.str.sprintf("/im_chat/image/%s/%s",self.get('session').uuid,current.from_id[0]));var date_day=current.create_date.split(" ")[0];if(date_day!==last_date_day){res[date_day]=[];last_user_id=-1;}
last_date_day=date_day;if(current.type=="message"){if(last_user_id===current.from_id[0]){_.last(res[date_day]).push(current);}else{res[date_day].push([current]);}
last_user_id=current.from_id[0];}else{res[date_day].push([current]);last_user_id=-1;}});this.$('.oe_im_chatview_content_bubbles').html($(odoo_support.qweb.render("im_chat.Conversation_content",{"list":res})));this._go_bottom();},keydown:function(e){if(e&&e.which==27){if(this.$el.prev().find('.oe_im_chatview_input').length>0){this.$el.prev().find('.oe_im_chatview_input').focus();}else{this.$el.next().find('.oe_im_chatview_input').focus();}
e.stopPropagation();this.update_fold_state('closed');}
if(e&&e.which!==13){return;}
var mes=this.$("input").val();if(!mes.trim()){return;}
this.$("input").val("");this.send_message(mes,"message");},_go_bottom:function(){this.$(".oe_im_chatview_content").scrollTop(this.$(".oe_im_chatview_content").get(0).scrollHeight);},add_user:function(user){return new odoo_support.Model("im_chat.session").call("add_user",[this.get("session").uuid,user.id]);},focus:function(){this.$(".oe_im_chatview_input").focus();},click_options:function(e){this.$('.oe_im_chatview_options').dropdown();},click_option_shortcut:function(){odoo_support.client.action_manager.do_action({type:'ir.actions.act_window',name:'Shortcode',res_model:'im_chat.shortcode',view_mode:'tree,form',view_type:'tree',views:[[false,'list'],[false,'form']],target:"new",limit:80,flags:{action_buttons:true,pager:true,}});},click_header:function(event){var classes=event.target.className.split(' ');if(_.contains(classes,'oe_im_chatview_header_name')||_.contains(classes,'oe_im_chatview_header')){this.update_fold_state();}},click_close:function(event){this.update_fold_state('closed');},destroy:function(){this.trigger("destroyed",this.get('session').uuid);return this._super();}});im_chat.UserWidget=odoo_support.Widget.extend({"template":"im_chat.UserWidget",events:{"click":"activate_user",},init:function(parent,user){this._super(parent);this.set("id",user.id);this.set("name",user.name);this.set("im_status",user.im_status);this.set("image_url",user.image_url);},start:function(){this.$el.data("user",{id:this.get("id"),name:this.get("name")});this.$el.draggable({helper:"clone"});this.on("change:im_status",this,this.update_status);this.update_status();},update_status:function(){this.$(".oe_im_user_online").toggle(this.get('im_status')!=='offline');var img_src=(this.get('im_status')=='away'?'/im_chat/static/src/img/yellow.png':'/im_chat/static/src/img/green.png');this.$(".oe_im_user_online").attr('src',img_src);},activate_user:function(){this.trigger("activate_user",this.get("id"));},});im_chat.InstantMessaging=odoo_support.Widget.extend({template:"im_chat.InstantMessaging",events:{"keydown .oe_im_searchbox":"input_change","keyup .oe_im_searchbox":"input_change","change .oe_im_searchbox":"input_change",},init:function(parent){this._super(parent);this.shown=false;this.set("right_offset",0);this.set("current_search","");this.users=[];this.widgets={};this.c_manager=new odoo_support.im_chat.ConversationManager(this);this.on("change:right_offset",this.c_manager,_.bind(function(){this.c_manager.set("right_offset",this.get("right_offset"));},this));this.user_search_dm=new odoo_support.web.DropMisordered();},start:function(){var self=this;this.$el.css("right",-this.$el.outerWidth());$(window).scroll(_.bind(this.calc_box,this));$(window).resize(_.bind(this.calc_box,this));this.calc_box();this.on("change:current_search",this,this.search_users_status);self.c_manager.on("im_session_activated",self,function(conv){conv.$el.droppable({drop:function(event,ui){conv.add_user(ui.draggable.data("user"));}});});this.c_manager.on("im_new_user_status",this,this.update_users_status);odoo_support.session.rpc("/im_chat/init",{}).then(function(notifications){_.each(notifications,function(notif){self.c_manager.on_notification(notif);});odoo_support.bus.bus.start_polling();});return;},calc_box:function(){var $topbar=window.$('#oe_main_menu_navbar');var top=$topbar.offset().top+$topbar.height();top=Math.max(top-$(window).scrollTop(),0);this.$el.css("top",top);this.$el.css("bottom",0);},input_change:function(){this.set("current_search",this.$(".oe_im_searchbox").val());},search_users_status:function(e){var user_model=new odoo_support.web.Model("res.users");var self=this;return this.user_search_dm.add(user_model.call("im_search",[this.get("current_search"),USERS_LIMIT],{context:new odoo_support.web.CompoundContext()})).then(function(result){self.$(".oe_im_input").val("");var old_widgets=self.widgets;self.widgets={};self.users=[];_.each(result,function(user){user.image_url=odoo_support.session.url('/web/binary/image',{model:'res.users',field:'image_small',id:user.id});var widget=new odoo_support.im_chat.UserWidget(self,user);widget.appendTo(self.$(".oe_im_users"));widget.on("activate_user",self,self.activate_user);self.widgets[user.id]=widget;self.users.push(user);});_.each(old_widgets,function(w){w.destroy();});});},switch_display:function(){this.calc_box();var fct=_.bind(function(place){this.set("right_offset",place+this.$el.outerWidth());this.$(".oe_im_searchbox").focus();},this);var opt={step:fct,};if(this.shown){this.$el.animate({right:-this.$el.outerWidth(),},opt);}else{if(!odoo_support.bus.bus.activated){this.do_warn("Instant Messaging is not activated on this server. Try later.","");return;}
this.search_users_status();this.$el.animate({right:0,},opt);}
this.shown=!this.shown;},activate_user:function(user_id){var self=this;var sessions=new odoo_support.web.Model("im_chat.session");return sessions.call("session_get",[user_id]).then(function(session){self.c_manager.activate_session(session,true);});},update_users_status:function(users_list){var self=this;_.each(users_list,function(el){self.widgets[el.id]&&self.widgets[el.id].set("im_status",el.im_status);});}});im_chat.ImTopButton=odoo_support.Widget.extend({template:'im_chat.ImTopButton',events:{"click":"clicked",},start:function(){var im=new odoo_support.im_chat.InstantMessaging(self);odoo_support.im_chat.single=im;im.appendTo(odoo_support.client.$el);this.on("clicked",im,im.switch_display);return this._super();},clicked:function(ev){ev.preventDefault();this.trigger("clicked");},});if(odoo_support.web&&odoo_support.web.Model){var Users=new odoo_support.web.Model('res.users');Users.call('has_group',['base.group_user']).done(function(is_employee){if(is_employee){odoo_support.web.SystrayItems.push(odoo_support.im_chat.ImTopButton);}});}
return im_chat;})();;

/* /im_livechat/static/src/js/im_livechat.js defined in bundle 'odoo_support_livechat.odoo_livechat_external_assets' */
(function(){"use strict";var _t=odoo_support._t;var im_livechat={};odoo_support.im_livechat=im_livechat;im_livechat.COOKIE_NAME='livechat_conversation';odoo_support.im_chat.Conversation.include({init:function(){this._super.apply(this,arguments);this.shown=true;this.loading_history=true;this.feedback=false;},define_options:function(){},show:function(){this._super.apply(this,arguments);this.shown=true;},hide:function(){this._super.apply(this,arguments);this.shown=false;},update_fold_state:function(state){if(state==='closed'){this.destroy();}else{if(state==='open'){this.show();}else{if(this.shown){state='fold';this.hide();}else{state='open';this.show();}}}
var session=this.get('session');session.state=state;this.set('session',session);odoo_support.set_cookie(im_livechat.COOKIE_NAME,JSON.stringify(session),60*60);},click_close:function(event){if(!this.feedback&&(this.get('messages').length>1)){this.feedback=new im_livechat.Feedback(this);this.$(".oe_im_chatview_content").empty();this.$(".oe_im_chatview_input").prop('disabled',true);this.feedback.appendTo(this.$(".oe_im_chatview_content"));this.feedback.on("feedback_sent",this,this.click_close);}else{this._super.apply(this,arguments);odoo_support.set_cookie(im_livechat.COOKIE_NAME,"",-1);odoo_support.set_cookie('im_livechat_auto_popup',JSON.stringify(false),60*60);}},});odoo_support.im_chat.ConversationManager.include({received_message:function(message){try{this._super(message);}catch(e){}}});odoo_support.set_cookie=function(name,value,ttl){ttl=ttl||24*60*60*365;document.cookie=[name+'='+value,'path=/','max-age='+ttl,'expires='+new Date(new Date().getTime()+ttl*1000).toGMTString()].join(';');};im_livechat.LiveSupport=odoo_support.Widget.extend({init:function(server_url,db,channel,options,rule){this._super();options=options||{};_.defaults(options,{buttonText:_t("Chat with one of our collaborators"),inputPlaceholder:null,defaultMessage:_t("How may I help you?"),defaultUsername:_t("Visitor"),});odoo_support.session=new odoo_support.Session(null,server_url,{use_cors:false});this.load_template(db,channel,options,rule);},_get_template_list:function(){return['/im_livechat/static/src/xml/im_livechat.xml','/im_chat/static/src/xml/im_chat.xml'];},load_template:function(db,channel,options,rule){var self=this;var defs=[];var templates=this._get_template_list();_.each(templates,function(tmpl){defs.push(odoo_support.session.rpc('/web/proxy/load',{path:tmpl}).then(function(xml){odoo_support.qweb.add_template(xml);}));});return $.when.apply($,defs).then(function(){self.setup(db,channel,options,rule);});},setup:function(db,channel,options,rule){var self=this;var session=odoo_support.get_cookie(im_livechat.COOKIE_NAME);if(session){self.build_button(channel,options,JSON.parse(session),rule);}else{odoo_support.session.rpc("/im_livechat/available",{db:db,channel:channel}).then(function(activated){if(activated){self.build_button(channel,options,false,rule);}});}},build_button:function(channel,options,session,rule){var button=new im_livechat.ChatButton(null,channel,options,session);button.appendTo($("body"));var auto_popup_cookie=odoo_support.get_cookie('im_livechat_auto_popup')?JSON.parse(odoo_support.get_cookie('im_livechat_auto_popup')):true;if(rule.action==='auto_popup'&&auto_popup_cookie){setTimeout(function(){button.click();},rule.auto_popup_timer*1000);}}});im_livechat.ChatButton=odoo_support.Widget.extend({className:"odoo_support_style oe_chat_button hidden-print",events:{"click":"click"},init:function(parent,channel,options,session){this._super(parent);this.channel=channel;this.options=options;this.text=options.buttonText;this.session=session||false;this.conv=false;this.no_session_message=_t("None of our collaborators seems to be available, please try again later.");},start:function(){this.$().append(odoo_support.qweb.render("im_livechat.chatButton",{widget:this}));this.manager=new odoo_support.im_chat.ConversationManager(this,this.options);this.manager.set("bottom_offset",$('.oe_chat_button').outerHeight());this.manager.notification=function(notif){alert(notif);}
if(this.session){this.set_conversation(this.session);}},click:function(){var self=this;if(!this.conv){odoo_support.session.rpc("/im_livechat/get_session",{"channel_id":self.channel,"anonymous_name":this.options["defaultUsername"]},{shadow:true}).then(function(session){if(!session){self.manager.notification(self.no_session_message);return;}
session.state='open';odoo_support.set_cookie(im_livechat.COOKIE_NAME,JSON.stringify(session),60*60);self.set_conversation(session,true);});}},set_conversation:function(session,welcome_message){var self=this;this.session=session;if(session.state==='closed'){return;}
this.conv=this.manager.apply_session(session);this.conv.on("destroyed",this,function(){odoo_support.bus.bus.stop_polling();delete self.conv;delete self.session;});odoo_support.bus.bus.add_channel(session.uuid);odoo_support.bus.bus.start_polling();if(welcome_message){this.send_welcome_message();}},send_welcome_message:function(){var self=this;if(this.session.users.length>0){if(self.options.defaultMessage){setTimeout(function(){var operator=_.last(_.filter(self.session.users,function(user){return user.is_operator}));self.conv.received_message({id:1,type:"message",message:self.options.defaultMessage,create_date:odoo_support.datetime_to_str(new Date()),from_id:[operator.id,operator.name],to_id:[0,self.session.uuid]});},1000);}}}});im_livechat.Feedback=odoo_support.Widget.extend({template:"im_livechat.feedback",init:function(parent){this._super(parent);this.conversation=parent;this.reason=false;this.rating=false;this.server_origin=odoo_support.session.origin;},start:function(){this._super.apply(this.arguments);this.$('.oe_livechat_rating_choices img').on('click',_.bind(this.click_smiley,this));this.$('#rating_submit').on('click',_.bind(this.click_send,this));},click_smiley:function(ev){var self=this;this.rating=parseInt($(ev.currentTarget).data('value'));this.$('.oe_livechat_rating_choices img').removeClass('selected');this.$('.oe_livechat_rating_choices img[data-value="'+this.rating+'"]').addClass('selected');var close_conv=false;if(this.rating==0){this.$('.oe_livechat_rating_reason').show();}else{this.$('.oe_livechat_rating_reason').hide();close_conv=true;}
this._send_feedback(close_conv).then(function(){self.$('textarea').val('');});},click_send:function(ev){this.reason=this.$('textarea').val();if(_.contains([0,5,10],this.rating)){this._send_feedback(true);}},_send_feedback:function(close){var self=this;var uuid=this.conversation.get('session').uuid;return odoo_support.session.rpc("/rating/livechat/feedback",{uuid:uuid,rate:this.rating,reason:this.reason}).then(function(res){if(close){self.trigger("feedback_sent");self.conversation.send_message(_.str.sprintf(_t("I rated you with :rating_%d"),self.rating),"message");}});}});return im_livechat;})();
            (function() {
                // prefix the cookie name
                odoo_support.im_livechat.COOKIE_NAME = 'odoo_'+odoo_support.im_livechat.COOKIE_NAME;
                var im_livechat = odoo_support.im_livechat;

                var _t = openerp._t;

                // TODO move this to openerpframework.js, ask xmo
                odoo_support.set_cookie = function(name, value, ttl) {
                    ttl = ttl || 24*60*60*365;
                    document.cookie = [
                        name + '=' + value,
                        'path=/',
                        'max-age=' + ttl,
                        'expires=' + new Date(new Date().getTime() + ttl*1000).toGMTString()
                    ].join(';');
                };

               odoo_support.im_livechat.LiveSupport = odoo_support.Widget.extend({
                    init: function(options, params) {
                        var self = this;
                        this._super();

                        var server_url = "https://www.odoo.com";
                        this.db = "openerp";
                        this.channel = 5;
                        this.params = params || {};

                        var channel_options = {"url": "https://www.odoo.com", "defaultMessage": "Hello, how can I help you?", "channelName": "Odoo Live Support", "inputPlaceholder": "How may I help you?", "buttonText": "Have a Question? Chat with us."} || {};
                        options = _.extend(channel_options, options || {});
                        this.options = _.defaults(options, {
                            buttonText: _t("Chat with one of our operators."),
                            inputPlaceholder: null,
                            defaultMessage: _t("How may I help you?"),
                            defaultUsername: _t("Client"),
                        });

                        odoo_support.qweb.default_dict['_s'] = server_url; // dont wnat to import core.js, so set here the default dict for img in qweb template
                        odoo_support.session = new odoo_support.Session(null, server_url, { use_cors: false });

                        this.manager = new odoo_support.im_chat.ConversationManager(null, this.options);
                        this.manager.notification = function(notif){ // override the notification default function
                            openerp.client.do_warn(notif, "");
                        }
                        // load template
                        var defs = [];
                        var templates = ['/im_chat/static/src/xml/im_chat.xml', 'im_livechat/static/src/xml/im_livechat.xml'];
                        _.each(templates, function(tmpl){
                            defs.push(odoo_support.session.rpc('/web/proxy/load', {path: tmpl}).then(function(xml) {
                                odoo_support.qweb.add_template(xml);
                            }));
                        });
                        $.when.apply($, defs).then(function() {
                            self.start();
                        });
                    },
                    start: function(){
                        var self = this;
                        var session = odoo_support.get_cookie(im_livechat.COOKIE_NAME);
                        if(session){
                            self.set_conversation(JSON.parse(session));
                        }else{
                            if(!this.conv){
                                var params = _.defaults({"channel_id" : self.channel, "anonymous_name" : this.params['username'] || this.options["defaultUsername"]}, self.params);
                                odoo_support.session.rpc("/im_livechat/get_session", params, {shadow: true}).then(function(session) {
                                    self.trigger('im_odoo_support_status', !!session);
                                    if (! session) {
                                        openerp.client.do_warn(_t("Beacon Support"),_t("None of our operators are available, try again later. Or please, send an email to support@officebeacon.com"), true);
                                        return;
                                    }
                                    session.state = 'open';
                                    // save the session in a cookie
                                    odoo_support.set_cookie(im_livechat.COOKIE_NAME, JSON.stringify(session), 60*60);
                                    // create the conversation with the received session
                                    self.set_conversation(session, true);
                                });
                            }
                        }
                    },
                    set_conversation: function(session, welcome_message){
                        var self = this;
                        this.session = session;
                        if(session.state === 'closed'){
                            return;
                        }
                        this.conv = this.manager.apply_session(session);

                        // start the polling
                        odoo_support.bus.bus.add_channel(session.uuid);
                        odoo_support.bus.bus.start_polling();
                        // add the automatic welcome message
                        if(welcome_message){
                            this.send_welcome_message();
                        }

                        if(openerp.im_chat){
                            // add the conversation to the IM conversation manager
                            var c_manager = openerp.im_chat.single.c_manager;
                            c_manager.sessions[session.uuid] = this.conv;
                            c_manager.calc_positions();
                            this.conv.on('destroyed', this, function(){
                                c_manager.delete_session(session.uuid);
                            });
                        }

                        this.conv.on("destroyed", this, function() {
                            odoo_support.bus.bus.stop_polling();
                            delete self.conv;
                            delete self.session;
                        });
                    },
                    send_welcome_message: function(){
                        var self = this;
                        if(this.session.users.length > 0){
                            if (self.options.defaultMessage) {
                                setTimeout(function(){
                                    self.conv.received_message({
                                        id : 1,
                                        type: "message",
                                        message: self.options.defaultMessage,
                                        create_date: openerp.datetime_to_str(new Date()),
                                        from_id: [self.session.users[0].id, self.session.users[0].name],
                                        to_id: [0, self.session.uuid]
                                    });
                                }, 1000);
                            }
                        }
                    },
                });

                odoo_support.im_chat.Conversation.include({
                    update_session: function() {
                        this._super();
                        this.$(".oe_im_chatview_header_name").text(_t("Odoo Support"));
                    },
                });

            })();

        